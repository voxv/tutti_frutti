import{T as m}from"./index-DhTA5Vhk.js";class y extends m{constructor(s={}){super({...s,type:s.type||"projectile"}),this.projectiles=[],this._bloonEntryTimes=new Map,this.targetingPriority=s.targetingPriority||"First"}acquireTarget(s){const g=Date.now(),a=new Set;for(const t of s)t&&t.isActive&&this.isInRange(t)&&(a.add(t),this._bloonEntryTimes.has(t)||this._bloonEntryTimes.set(t,g));for(const t of this._bloonEntryTimes.keys())a.has(t)||this._bloonEntryTimes.delete(t);const l=this.targetingPriority||"First",r=Array.from(a);if(r.length===0)return this.target=null,null;let n=null;if(l==="First")n=r.reduce((t,e)=>e.progress>t.progress?e:t,r[0]);else if(l==="Last"){n=r.reduce((i,o)=>this._bloonEntryTimes.get(o)>this._bloonEntryTimes.get(i)?o:i,r[0]);const t=this._bloonEntryTimes.get(n),e=r.filter(i=>this._bloonEntryTimes.get(i)===t);e.length>1&&(n=e.reduce((i,o)=>o.progress<i.progress?o:i,e[0]))}else l==="Strong"?n=r.reduce((t,e)=>{const i=typeof e.damage=="number"?e.damage:1,o=typeof t.damage=="number"?t.damage:1;return i>o?e:t},r[0]):n=r[0];return this.target=n,n}fire(s,g){(!this.target||!this.isInRange(this.target))&&this.acquireTarget(s)}update(s,g){let a=Date.now()/1e3;this.fire(g,a)}}export{y as ProjectileTower};
