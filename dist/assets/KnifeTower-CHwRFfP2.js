import{T as f}from"./Tower-Cv7v0p7_.js";import{t as n}from"./index-C4C5Q25b.js";class a extends f{constructor(i={}){super({...i,type:"aoe"})}acquireTarget(i){return null}fire(i,e){if(e-this.lastShotTime>=1/this.fireRate){this.lastShotTime=e;for(const t of i)t.isActive&&this.isInRange(t)&&(t.takeDamage(this.damage),!t.isActive&&!(t.isAtEnd&&t.isAtEnd())&&typeof window.sceneRef=="object"&&window.sceneRef&&(window.sceneRef.goldAmount+=t.reward,window.sceneRef.goldText&&window.sceneRef.goldText.setText(String(window.sceneRef.goldAmount)),typeof window.sceneRef._refreshShopAvailability=="function"&&window.sceneRef._refreshShopAvailability(),typeof window.sceneRef.refreshUpgradeUIIfVisible=="function"&&window.sceneRef.refreshUpgradeUIIfVisible()));if(typeof window.sceneRef=="object"&&window.sceneRef){const t=window.sceneRef.add.circle(this.position.x,this.position.y,this.range*.5,16776960,.4);t.setDepth(3e3),window.sceneRef.tweens.add({targets:t,alpha:0,scale:2,duration:200,onComplete:()=>t.destroy()})}}}update(i,e){let t=Date.now()/1e3;this.fire(e,t)}}class w extends a{constructor(i={}){let e={range:120,fireRate:1,damage:1,cost:200,type:"knife"};n&&n.knife&&(e={...e,...n.knife}),super({...e,...i,type:"knife"})}upgrade(){this.level++,this.range+=20,this.damage+=1,this.fireRate+=.2,this.cost+=100,this.upgrades.push({level:this.level})}acquireTarget(i){for(const e of i)if(e.isActive&&this.isInRange(e))return this.target=e,e;return this.target=null,null}update(i,e){let t=Date.now()/1e3;if((!this.target||!this.isInRange(this.target))&&this.acquireTarget(e),this.target&&t-this.lastShotTime>=1/this.fireRate&&(this.lastShotTime=t,this.target.isActive&&!(this.target.isAtEnd&&this.target.isAtEnd()))){if(this.target.takeDamage(this.damage),!this.target.isActive&&!(this.target.isAtEnd&&this.target.isAtEnd())&&typeof window.sceneRef=="object"&&window.sceneRef&&(window.sceneRef.goldAmount+=this.target.reward,window.sceneRef.goldText&&window.sceneRef.goldText.setText(String(window.sceneRef.goldAmount)),typeof window.sceneRef._refreshShopAvailability=="function"&&window.sceneRef._refreshShopAvailability(),typeof window.sceneRef.refreshUpgradeUIIfVisible=="function"&&window.sceneRef.refreshUpgradeUIIfVisible()),typeof window.sceneRef=="object"&&window.sceneRef){const s=window.sceneRef.add.circle(this.position.x,this.position.y,this.range*.5,16776960,.4);s.setDepth(3e3),window.sceneRef.tweens.add({targets:s,alpha:0,scale:2,duration:200,onComplete:()=>s.destroy()})}this.acquireTarget(e)}}}export{w as KnifeTower};
